GROMACS 2018.3 release notes
----------------------------

This version was released on TODO, 2018. These release notes document
the changes that have taken place in GROMACS since version 2018.2, to fix known
issues. It also incorporates all fixes made in version TODO and
earlier, which you can find described in the :ref:`release-notes`.

Fixes where mdrun could behave incorrectly
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Fix Conjugate Gradient assertion failure at end of minimization
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

When the final step coincided with a coordinate output step,
conjugate gradient minimization would exit with an assertion failure
instead of writing confout.gro.

:issue:`2554`

Multi-domain Conjugate Gradient minimimization no longer segfaults.
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

:issue:`2554`

Fix pairlist buffer with Brownian Dynamics
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

With Brownian Dynamics and bd-fric > 0, the Verlet pairlist buffer would
be determined with incorrect masses for constrained atoms and virtual
sites. This would lead to a too small buffer for typical atomistic
systems with constraints.

:issue:`2613`

Avoid "atom moved to far" errors
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

The introduction of the dual pair list has led to larger nstlist values,
which leads to larger atom displacements between domain decomposition
steps. This has made it more likely that the errors
"An atom moved too far between two domain decomposition steps" and
"N particles communicated to PME rank M are more than 2/3 times the cut-off
out of the domain decomposition cell ..." appear for stable systems.
Now atom displacements are correctly taken into account when determining
the minimum cell size, so these errors should only appear for unstable systems.

:issue:`2614`

grompp now checks that pull groups are not close to half the box size
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

Pull groups that use a reference atom for periodic boundary treatment
should have all their atoms well within half the box size of this reference.
When this is not the case, grompp will issue a warning.

:issue:`2397`

Fixed segmentation fault in mdrun with QM/MM ONIOM scheme
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

:issue:`2617`

Fixes for ``gmx`` tools
^^^^^^^^^^^^^^^^^^^^^^^

Fix bfactor output error caused by fix for :issue:`2511`
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
The fix for the PQR file output broke the output of bfactors from other tools.

:issue:`2575`

Made sure that gmx rms can skip values
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
When requested to skip values, gmx rms would still output all values despite
the option. Now it only outputs values that are requested to be processed.

:issue:`2565`

Fixes to improve portability
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Miscellaneous
^^^^^^^^^^^^^

Flush denorms to zero in OpenCL kernels
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
The OpenCL kernel optimization flags did not explicitly turn off denorm handling
which could lead to performance loss. The optimization is now explicitly turned
on both for consistency with CUDA and performance reasons.
On AMD Vega GPUs (with ROCm) kernel performance improves by up to 30%.


